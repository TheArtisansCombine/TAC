<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decido - Let Fate Decide!</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f4f8; /* Light blue-gray background */
            margin: 0;
        }
        /* Custom message box styling (instead of alert()) */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50; /* Green */
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            font-weight: 600;
        }
        .message-box.show {
            opacity: 1;
        }

        /* Basic animation for coin flip and die roll - placeholder for now */
        .decision-display {
            min-height: 12rem; /* Ensure space for animation */
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1.5rem; /* Space between multiple coins/dice */
            flex-wrap: wrap; /* Allow items to wrap on smaller screens */
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748; /* Darker text */
        }

        /* CSS for the coin flip animation */
        .coin {
            width: 80px;
            height: 80px;
            background-color: #fcd34d; /* Gold-like color */
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #3b444b;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: relative;
            transform-style: preserve-3d;
            animation: none; /* Controlled by JS */
        }

        .coin.flipping {
            animation: flip 1s ease-out forwards;
        }

        @keyframes flip {
            0% { transform: rotateX(0deg); }
            50% { transform: rotateX(1800deg); } /* Multiple spins */
            100% { transform: rotateX(3600deg); }
        }

        /* CSS for the die roll animation (simple version) */
        .die {
            width: 80px;
            height: 80px;
            background-color: #e2e8f0; /* Light gray */
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: 700;
            color: #2d3748;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            animation: none; /* Controlled by JS */
        }

        .die.rolling {
            animation: roll 0.5s infinite linear;
        }

        @keyframes roll {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Transition classes for cards */
        .card-transition {
            transition: opacity 0.5s ease-in-out, max-height 0.5s ease-in-out;
            overflow: hidden;
        }
        .card-hidden {
            opacity: 0;
            max-height: 0;
            padding-top: 0;
            padding-bottom: 0;
            margin-top: 0;
            margin-bottom: 0;
            visibility: hidden; /* Prevent interaction when hidden */
        }
        .card-visible {
            opacity: 1;
            max-height: 1000px; /* Large enough to cover content */
            visibility: visible; /* Make interactable when visible */
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4 sm:p-6 md:p-8">
    <div class="max-w-4xl w-full bg-white rounded-2xl shadow-xl p-6 sm:p-8 md:p-10 lg:p-12 space-y-8">
        <!-- App Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 tracking-tight mb-2">Decido</h1>
            <p class="text-lg text-gray-600">When you canâ€™t decide, let Decido decide for you.</p>
        </header>

        <!-- Main Card Container -->
        <div id="mainCardContainer">
            <!-- Initial Decision Selection Card -->
            <section id="decisionSelectionCard" class="card-transition card-visible bg-gradient-to-br from-purple-500 to-indigo-600 p-6 sm:p-8 rounded-xl shadow-lg text-white text-center space-y-6">
                <h2 class="text-3xl sm:text-4xl font-bold mb-4">What's your dilemma?</h2>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <button id="showCoinCountBtn"
                            class="bg-white text-purple-700 hover:bg-purple-100 font-bold py-4 px-8 rounded-lg shadow-md
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   text-xl w-full sm:w-auto">
                        Flip a Coin
                    </button>
                    <button id="showDieCountBtn"
                            class="bg-white text-indigo-700 hover:bg-indigo-100 font-bold py-4 px-8 rounded-lg shadow-md
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   text-xl w-full sm:w-auto">
                        Roll a Die
                    </button>
                </div>
            </section>

            <!-- Count Selection Card -->
            <section id="countSelectionCard" class="card-transition card-hidden" style="display: none;">
                <div class="bg-gray-100 p-6 sm:p-8 rounded-xl shadow-md border border-gray-200">
                    <h2 id="countSelectionTitle" class="text-3xl font-bold text-gray-800 mb-6 text-center">How many?</h2>
                    <div class="flex justify-center gap-4 mb-6">
                        <button class="count-btn bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95 text-lg" data-count="1">1</button>
                        <button class="count-btn bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95 text-lg" data-count="2">2</button>
                        <button class="count-btn bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95 text-lg" data-count="3">3</button>
                    </div>
                    <div class="flex justify-center">
                        <button id="backToMainBtn"
                                class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-6 rounded-lg shadow-lg
                                       transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                       w-full sm:w-auto text-lg">
                            Back
                        </button>
                    </div>
                </div>
            </section>

            <!-- Coin Flip Section -->
            <section id="coinCard" class="card-transition card-hidden" style="display: none;">
                <div class="bg-yellow-50 p-6 sm:p-8 rounded-xl shadow-md border border-yellow-200">
                    <h2 id="coinCardTitle" class="text-3xl font-bold text-yellow-800 mb-6 text-center">Flip a Coin</h2>

                    <!-- Coin Display and Result -->
                    <div id="coinResultDisplay" class="decision-display mb-8 text-yellow-700">
                        <!-- Coins will be dynamically added here -->
                    </div>

                    <!-- Coin Actions -->
                    <div class="flex flex-col sm:flex-row justify-center gap-4">
                        <button id="flipCoinBtn"
                                class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg
                                    transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                    w-full sm:w-auto text-lg">
                            Flip
                        </button>
                    </div>
                    <div id="coinPostDecisionActions" class="flex flex-col sm:flex-row justify-center gap-4 mt-4 hidden">
                        <button id="changeCoinCountBtn"
                                class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg
                                    transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                    w-full sm:w-auto text-lg">
                            Change Count
                        </button>
                        <button id="changeToDieBtn"
                                class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-6 rounded-lg shadow-lg
                                    transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                    w-full sm:w-auto text-lg">
                            Change to Die
                        </button>
                    </div>
                </div>
            </section>

            <!-- Die Roll Section -->
            <section id="dieCard" class="card-transition card-hidden" style="display: none;">
                <div class="bg-blue-50 p-6 sm:p-8 rounded-xl shadow-md border border-blue-200">
                    <h2 id="dieCardTitle" class="text-3xl font-bold text-blue-800 mb-6 text-center">Roll a Die</h2>

                    <!-- Die Display and Result -->
                    <div id="dieResultDisplay" class="decision-display mb-8 text-blue-700">
                        <!-- Dice will be dynamically added here -->
                    </div>

                    <!-- Die Actions -->
                    <div class="flex flex-col sm:flex-row justify-center gap-4">
                        <button id="rollDieBtn"
                                class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg
                                    transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                    w-full sm:w-auto text-lg">
                            Roll
                        </button>
                    </div>
                    <div id="diePostDecisionActions" class="flex flex-col sm:flex-row justify-center gap-4 mt-4 hidden">
                        <button id="changeDieCountBtn"
                                class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg
                                    transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                    w-full sm:w-auto text-lg">
                            Change Count
                        </button>
                        <button id="changeToCoinBtn"
                                class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-6 rounded-lg shadow-lg
                                    transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                    w-full sm:w-auto text-lg">
                            Change to Coin
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Message Box for Alerts -->
    <div id="messageBox" class="message-box"></div>

    <script>
        // Utility function to show a custom message box instead of alert()
        function showMessage(message, type = 'success', duration = 3000) {
            const msgBox = document.getElementById('messageBox');
            msgBox.textContent = message;
            msgBox.className = 'message-box show'; // Reset classes and show
            if (type === 'error') {
                msgBox.style.backgroundColor = '#f44336'; // Red for error
            } else if (type === 'info') {
                msgBox.style.backgroundColor = '#2196F3'; // Blue for info
            } else {
                msgBox.style.backgroundColor = '#4CAF50'; // Green for success
            }

            setTimeout(() => {
                msgBox.classList.remove('show');
            }, duration);
        }

        // --- Card Visibility Management ---
        const decisionSelectionCard = document.getElementById('decisionSelectionCard');
        const countSelectionCard = document.getElementById('countSelectionCard');
        const coinCard = document.getElementById('coinCard');
        const dieCard = document.getElementById('dieCard');

        const showCoinCountBtn = document.getElementById('showCoinCountBtn');
        const showDieCountBtn = document.getElementById('showDieCountBtn');
        const backToMainBtn = document.getElementById('backToMainBtn');
        const countSelectionTitle = document.getElementById('countSelectionTitle');
        const countButtons = document.querySelectorAll('.count-btn');

        const changeToDieBtn = document.getElementById('changeToDieBtn');
        const changeToCoinBtn = document.getElementById('changeToCoinBtn');
        const changeCoinCountBtn = document.getElementById('changeCoinCountBtn');
        const changeDieCountBtn = document.getElementById('changeDieCountBtn');

        const coinCardTitle = document.getElementById('coinCardTitle'); // Reference to coin card title
        const dieCardTitle = document.getElementById('dieCardTitle');   // Reference to die card title


        let currentDecisionType = ''; // 'coin' or 'die'
        let currentCount = 1; // Default count for coins/dice

        function showCard(cardToShow, type = '') {
            // First, process all cards to be hidden
            [decisionSelectionCard, countSelectionCard, coinCard, dieCard].forEach(card => {
                if (card !== cardToShow) {
                    card.classList.remove('card-visible');
                    card.classList.add('card-hidden');
                    // After the CSS transition completes, set display to 'none'
                    setTimeout(() => {
                        if (card.classList.contains('card-hidden')) { // Only apply if still hidden
                            card.style.display = 'none';
                        }
                    }, 500); // Must match CSS transition duration
                }
            });

            // Then, immediately prepare and show the target card
            cardToShow.style.display = 'block'; // Ensure it's in the flow
            // Small delay to ensure browser registers 'display: block' before animating max-height
            setTimeout(() => {
                cardToShow.classList.remove('card-hidden');
                cardToShow.classList.add('card-visible');
            }, 10);

            if (cardToShow === countSelectionCard) {
                currentDecisionType = type;
                countSelectionTitle.textContent = `How many ${type === 'coin' ? 'coins' : 'dice'}?`;
            } else if (cardToShow === coinCard) {
                updateCoinDisplay(); // Ensure display and title are updated when coinCard is shown
            } else if (cardToShow === dieCard) {
                updateDieDisplay(); // Ensure display and title are updated when dieCard is shown
            }
        }

        // Event listeners for initial decision selection
        showCoinCountBtn.addEventListener('click', () => showCard(countSelectionCard, 'coin'));
        showDieCountBtn.addEventListener('click', () => showCard(countSelectionCard, 'die'));
        backToMainBtn.addEventListener('click', () => showCard(decisionSelectionCard));

        // Event listeners for count selection buttons
        countButtons.forEach(button => {
            button.addEventListener('click', () => {
                currentCount = parseInt(button.dataset.count, 10);
                if (currentDecisionType === 'coin') {
                    showCard(coinCard);
                } else if (currentDecisionType === 'die') {
                    showCard(dieCard);
                }
            });
        });

        // Event listeners for post-decision actions
        changeToDieBtn.addEventListener('click', () => showCard(countSelectionCard, 'die')); // Updated
        changeToCoinBtn.addEventListener('click', () => showCard(countSelectionCard, 'coin')); // Updated
        changeCoinCountBtn.addEventListener('click', () => showCard(countSelectionCard, 'coin'));
        changeDieCountBtn.addEventListener('click', () => showCard(countSelectionCard, 'die'));


        // --- Coin Flip Logic ---
        const flipCoinBtn = document.getElementById('flipCoinBtn');
        const coinResultDisplay = document.getElementById('coinResultDisplay');
        const coinPostDecisionActions = document.getElementById('coinPostDecisionActions');

        // Coin options are now fixed to Heads/Tails
        const coinOptions = ["Heads", "Tails"];

        // Function to update the visual display of coins
        function updateCoinDisplay(results = []) {
            coinResultDisplay.innerHTML = ''; // Clear previous coins
            for (let i = 0; i < currentCount; i++) {
                const coinDiv = document.createElement('div');
                coinDiv.classList.add('coin');
                coinDiv.textContent = results[i] || '?'; // Show result or '?'
                coinDiv.dataset.index = i; // Store index for animation
                coinResultDisplay.appendChild(coinDiv);
            }
            // Update the title based on currentCount
            coinCardTitle.textContent = currentCount > 1 ? 'Flip Coins' : 'Flip a Coin';
        }

        // Event listener for Flip Coin button
        flipCoinBtn.addEventListener('click', () => {
            const coinElements = coinResultDisplay.querySelectorAll('.coin');
            coinPostDecisionActions.classList.add('hidden'); // Hide post-decision actions during flip
            flipCoinBtn.disabled = true; // Disable button during animation

            coinElements.forEach((coinEl, index) => {
                const chosenOption = coinOptions[Math.floor(Math.random() * coinOptions.length)];

                coinEl.textContent = '?'; // Reset text
                coinEl.classList.add('flipping');

                setTimeout(() => {
                    coinEl.classList.remove('flipping');
                    coinEl.textContent = chosenOption;
                    if (index === coinElements.length - 1) { // Only re-enable after last coin finishes
                        flipCoinBtn.disabled = false;
                        coinPostDecisionActions.classList.remove('hidden'); // Show post-decision actions
                    }
                }, 1000 + (index * 100)); // Stagger animations slightly
            });
        });


        // --- Die Roll Logic ---
        const rollDieBtn = document.getElementById('rollDieBtn');
        const dieResultDisplay = document.getElementById('dieResultDisplay');
        const diePostDecisionActions = document.getElementById('diePostDecisionActions');

        // Die will now always roll a 6-sided die
        const defaultNumberOfSides = 6;

        // Function to update the visual display of dice
        function updateDieDisplay(results = []) {
            dieResultDisplay.innerHTML = ''; // Clear previous dice
            for (let i = 0; i < currentCount; i++) {
                const dieDiv = document.createElement('div');
                dieDiv.classList.add('die');
                dieDiv.textContent = results[i] || '?'; // Show result or '?'
                dieDiv.dataset.index = i; // Store index for animation
                dieResultDisplay.appendChild(dieDiv);
            }
            // Update the title based on currentCount
            dieCardTitle.textContent = currentCount > 1 ? 'Roll Dice' : 'Roll a Die';
        }

        // Event listener for Roll Die button
        rollDieBtn.addEventListener('click', () => {
            const dieElements = dieResultDisplay.querySelectorAll('.die');
            diePostDecisionActions.classList.add('hidden'); // Hide post-decision actions during roll
            rollDieBtn.disabled = true; // Disable button during animation

            dieElements.forEach((dieEl, index) => {
                const chosenOption = Math.floor(Math.random() * defaultNumberOfSides) + 1;

                dieEl.textContent = '?'; // Reset text
                dieEl.classList.add('rolling');

                setTimeout(() => {
                    dieEl.classList.remove('rolling');
                    dieEl.textContent = chosenOption;
                    if (index === dieElements.length - 1) { // Only re-enable after last die finishes
                        rollDieBtn.disabled = false;
                        diePostDecisionActions.classList.remove('hidden'); // Show post-decision actions
                    }
                }, 500 + (index * 100)); // Stagger animations slightly
            });
        });
    </script>
</body>
</html>
