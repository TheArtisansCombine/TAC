<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decido - Let Fate Decide!</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f4f8; /* Light blue-gray background */
            margin: 0;
        }
        /* Custom message box styling (instead of alert()) */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50; /* Green */
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            font-weight: 600;
        }
        .message-box.show {
            opacity: 1;
        }

        /* Basic animation for coin flip and die roll - placeholder for now */
        .decision-display {
            min-height: 12rem; /* Ensure space for animation */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748; /* Darker text */
        }

        /* CSS for the coin flip animation */
        .coin {
            width: 80px;
            height: 80px;
            background-color: #fcd34d; /* Gold-like color */
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #3b444b;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: relative;
            transform-style: preserve-3d;
            animation: none; /* Controlled by JS */
        }

        .coin.flipping {
            animation: flip 1s ease-out forwards;
        }

        @keyframes flip {
            0% { transform: rotateX(0deg); }
            50% { transform: rotateX(1800deg); } /* Multiple spins */
            100% { transform: rotateX(3600deg); }
        }

        /* CSS for the die roll animation (simple version) */
        .die {
            width: 80px;
            height: 80px;
            background-color: #e2e8f0; /* Light gray */
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: 700;
            color: #2d3748;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            animation: none; /* Controlled by JS */
        }

        .die.rolling {
            animation: roll 0.5s infinite linear;
        }

        @keyframes roll {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Transition classes for cards */
        .card-transition {
            transition: opacity 0.5s ease-in-out, max-height 0.5s ease-in-out;
            overflow: hidden;
        }
        .card-hidden {
            opacity: 0;
            max-height: 0;
            padding-top: 0;
            padding-bottom: 0;
            margin-top: 0;
            margin-bottom: 0;
            /* Added to collapse the card completely when hidden */
            display: none; /* Hide completely after transition */
        }
        .card-visible {
            opacity: 1;
            max-height: 1000px; /* Large enough to cover content */
            display: block; /* Ensure it's displayed */
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4 sm:p-6 md:p-8">
    <div class="max-w-4xl w-full bg-white rounded-2xl shadow-xl p-6 sm:p-8 md:p-10 lg:p-12 space-y-8">
        <!-- App Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 tracking-tight mb-2">Decido</h1>
            <p class="text-lg text-gray-600">When you canâ€™t decide, let Decido decide for you.</p>
        </header>

        <!-- Main Card Container -->
        <div id="mainCardContainer" class="relative">
            <!-- Initial Decision Selection Card -->
            <section id="decisionSelectionCard" class="card-transition card-visible bg-gradient-to-br from-purple-500 to-indigo-600 p-6 sm:p-8 rounded-xl shadow-lg text-white text-center space-y-6">
                <h2 class="text-3xl sm:text-4xl font-bold mb-4">What's your dilemma?</h2>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <button id="showCoinCardBtn"
                            class="bg-white text-purple-700 hover:bg-purple-100 font-bold py-4 px-8 rounded-lg shadow-md
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   text-xl w-full sm:w-auto">
                        Flip a Coin
                    </button>
                    <button id="showDieCardBtn"
                            class="bg-white text-indigo-700 hover:bg-indigo-100 font-bold py-4 px-8 rounded-lg shadow-md
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   text-xl w-full sm:w-auto">
                        Roll a Die
                    </button>
                </div>
            </section>

            <!-- Coin Flip Section -->
            <section id="coinCard" class="card-transition card-hidden bg-yellow-50 p-6 sm:p-8 rounded-xl shadow-md border border-yellow-200">
                <h2 class="text-3xl font-bold text-yellow-800 mb-6 text-center">Flip a Coin</h2>

                <!-- Coin Display and Result -->
                <div id="coinResultDisplay" class="decision-display mb-8 text-yellow-700">
                    <div id="coinAnimation" class="coin">?</div>
                </div>

                <!-- Coin Customization Inputs -->
                <div id="coinCustomizationInputs" class="space-y-4 mb-6 hidden">
                    <div>
                        <label for="coinOption1" class="block text-gray-700 text-sm font-semibold mb-2">Option 1:</label>
                        <input type="text" id="coinOption1" value="Heads"
                               class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
                    </div>
                    <div>
                        <label for="coinOption2" class="block text-gray-700 text-sm font-semibold mb-2">Option 2:</label>
                        <input type="text" id="coinOption2" value="Tails"
                               class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
                    </div>
                </div>

                <!-- Coin Actions -->
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <button id="flipCoinBtn"
                            class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   w-full sm:w-auto text-lg">
                        Flip Coin
                    </button>
                    <button id="customizeCoinBtn"
                            class="bg-yellow-300 hover:bg-yellow-400 text-yellow-800 font-bold py-3 px-6 rounded-lg shadow-lg
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   w-full sm:w-auto text-lg">
                        Customize
                    </button>
                </div>
                <div id="coinPostDecisionActions" class="flex flex-col sm:flex-row justify-center gap-4 mt-4 hidden">
                    <button id="goAgainCoinBtn"
                            class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   w-full sm:w-auto text-lg">
                        Go Again
                    </button>
                    <button id="changeToDieBtn"
                            class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-6 rounded-lg shadow-lg
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   w-full sm:w-auto text-lg">
                        Change to Die
                    </button>
                </div>
            </section>

            <!-- Die Roll Section -->
            <section id="dieCard" class="card-transition card-hidden bg-blue-50 p-6 sm:p-8 rounded-xl shadow-md border border-blue-200">
                <h2 class="text-3xl font-bold text-blue-800 mb-6 text-center">Roll a Die</h2>

                <!-- Die Display and Result -->
                <div id="dieResultDisplay" class="decision-display mb-8 text-blue-700">
                    <div id="dieAnimation" class="die">?</div>
                </div>

                <!-- Die Customization Inputs -->
                <div id="dieCustomizationInputs" class="space-y-4 mb-6 hidden">
                    <div>
                        <label for="numberOfSides" class="block text-gray-700 text-sm font-semibold mb-2">Number of Sides:</label>
                        <input type="number" id="numberOfSides" value="6" min="2"
                               class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label for="dieCustomOptions" class="block text-gray-700 text-sm font-semibold mb-2">Or, Custom Options (comma-separated):</label>
                        <input type="text" id="dieCustomOptions" placeholder="e.g., Movie A, Movie B, Movie C"
                               class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <!-- Die Actions -->
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <button id="rollDieBtn"
                            class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   w-full sm:w-auto text-lg">
                        Roll Die
                    </button>
                    <button id="customizeDieBtn"
                            class="bg-blue-300 hover:bg-blue-400 text-blue-800 font-bold py-3 px-6 rounded-lg shadow-lg
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   w-full sm:w-auto text-lg">
                        Customize
                    </button>
                </div>
                <div id="diePostDecisionActions" class="flex flex-col sm:flex-row justify-center gap-4 mt-4 hidden">
                    <button id="goAgainDieBtn"
                            class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   w-full sm:w-auto text-lg">
                        Go Again
                    </button>
                    <button id="changeToCoinBtn"
                            class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-6 rounded-lg shadow-lg
                                   transition duration-300 ease-in-out transform hover:-translate-y-1 active:scale-95
                                   w-full sm:w-auto text-lg">
                        Change to Coin
                    </button>
                </div>
            </section>
        </div>
    </div>

    <!-- Message Box for Alerts -->
    <div id="messageBox" class="message-box"></div>

    <script>
        // Utility function to show a custom message box instead of alert()
        function showMessage(message, type = 'success', duration = 3000) {
            const msgBox = document.getElementById('messageBox');
            msgBox.textContent = message;
            msgBox.className = 'message-box show'; // Reset classes and show
            if (type === 'error') {
                msgBox.style.backgroundColor = '#f44336'; // Red for error
            } else if (type === 'info') {
                msgBox.style.backgroundColor = '#2196F3'; // Blue for info
            } else {
                msgBox.style.backgroundColor = '#4CAF50'; // Green for success
            }

            setTimeout(() => {
                msgBox.classList.remove('show');
            }, duration);
        }

        // --- Card Visibility Management ---
        const decisionSelectionCard = document.getElementById('decisionSelectionCard');
        const coinCard = document.getElementById('coinCard');
        const dieCard = document.getElementById('dieCard');

        const showCoinCardBtn = document.getElementById('showCoinCardBtn');
        const showDieCardBtn = document.getElementById('showDieCardBtn');
        const changeToDieBtn = document.getElementById('changeToDieBtn');
        const changeToCoinBtn = document.getElementById('changeToCoinBtn');

        function showCard(cardToShow) {
            // Hide all cards
            [decisionSelectionCard, coinCard, dieCard].forEach(card => {
                card.classList.remove('card-visible');
                card.classList.add('card-hidden');
                // Ensure display:none is applied after transition for true collapse
                setTimeout(() => card.style.display = 'none', 500); // Match transition duration
            });

            // Show the target card
            cardToShow.style.display = 'block'; // Ensure it's block before animating
            // A small delay might be needed to ensure display: block is processed before transition
            setTimeout(() => {
                cardToShow.classList.remove('card-hidden');
                cardToShow.classList.add('card-visible');
            }, 10); // Small delay
        }

        showCoinCardBtn.addEventListener('click', () => showCard(coinCard));
        showDieCardBtn.addEventListener('click', () => showCard(dieCard));
        changeToDieBtn.addEventListener('click', () => showCard(dieCard));
        changeToCoinBtn.addEventListener('click', () => showCard(coinCard));


        // --- Coin Flip Logic ---
        const coinOption1Input = document.getElementById('coinOption1');
        const coinOption2Input = document.getElementById('coinOption2');
        const flipCoinBtn = document.getElementById('flipCoinBtn');
        const customizeCoinBtn = document.getElementById('customizeCoinBtn');
        const goAgainCoinBtn = document.getElementById('goAgainCoinBtn');
        const coinCustomizationInputs = document.getElementById('coinCustomizationInputs');
        const coinAnimation = document.getElementById('coinAnimation');
        const coinPostDecisionActions = document.getElementById('coinPostDecisionActions');

        let coinOptions = ["Heads", "Tails"]; // Default options

        // Function to update coin options from input fields
        function updateCoinOptions() {
            const opt1 = coinOption1Input.value.trim();
            const opt2 = coinOption2Input.value.trim();
            if (opt1 && opt2) {
                coinOptions = [opt1, opt2];
            } else if (opt1 || opt2) { // If only one option is provided
                showMessage("Please provide two options for the coin.", "error");
                return false;
            } else {
                coinOptions = ["Heads", "Tails"]; // Fallback to defaults
            }
            return true;
        }

        // Event listener for Flip Coin button
        flipCoinBtn.addEventListener('click', () => {
            if (!updateCoinOptions()) return; // Update options and validate
            const resultIndex = Math.floor(Math.random() * coinOptions.length);
            const chosenOption = coinOptions[resultIndex];

            // Start coin flip animation
            coinAnimation.textContent = '?'; // Reset text
            coinAnimation.classList.add('flipping');
            flipCoinBtn.disabled = true; // Disable button during animation
            customizeCoinBtn.disabled = true;
            coinPostDecisionActions.classList.add('hidden'); // Hide post-decision actions during flip

            setTimeout(() => {
                coinAnimation.classList.remove('flipping');
                coinAnimation.textContent = chosenOption;
                flipCoinBtn.disabled = false; // Re-enable button
                customizeCoinBtn.disabled = false;
                coinPostDecisionActions.classList.remove('hidden'); // Show post-decision actions
            }, 1000); // Animation duration
        });

        // Event listener for Customize Coin button
        customizeCoinBtn.addEventListener('click', () => {
            coinCustomizationInputs.classList.toggle('hidden');
            if (!coinCustomizationInputs.classList.contains('hidden')) {
                customizeCoinBtn.textContent = 'Save Options';
            } else {
                customizeCoinBtn.textContent = 'Customize';
                if(updateCoinOptions()) { // Save options and show message if successful
                    showMessage("Coin options saved!", "info");
                }
            }
        });

        // Event listener for Go Again Coin button
        goAgainCoinBtn.addEventListener('click', () => {
            // Re-run the flip with the current options
            flipCoinBtn.click();
        });


        // --- Die Roll Logic ---
        const numberOfSidesInput = document.getElementById('numberOfSides');
        const dieCustomOptionsInput = document.getElementById('dieCustomOptions');
        const rollDieBtn = document.getElementById('rollDieBtn');
        const customizeDieBtn = document.getElementById('customizeDieBtn');
        const goAgainDieBtn = document.getElementById('goAgainDieBtn');
        const dieCustomizationInputs = document.getElementById('dieCustomizationInputs');
        const dieAnimation = document.getElementById('dieAnimation');
        const diePostDecisionActions = document.getElementById('diePostDecisionActions');

        let dieOptions = []; // Will be populated based on user input or number of sides
        let currentNumberOfSides = 6; // Default

        // Function to update die options from input fields
        function updateDieOptions() {
            const customOptsText = dieCustomOptionsInput.value.trim();
            if (customOptsText) {
                dieOptions = customOptsText.split(',').map(opt => opt.trim()).filter(opt => opt !== '');
                if (dieOptions.length < 2) {
                    showMessage("Please provide at least two custom options for the die, or specify number of sides.", "error");
                    return false;
                }
                numberOfSidesInput.disabled = true; // Disable number of sides if custom options are used
                numberOfSidesInput.value = ''; // Clear number of sides input
            } else {
                dieOptions = []; // Clear custom options
                numberOfSidesInput.disabled = false;
                const sides = parseInt(numberOfSidesInput.value, 10);
                if (isNaN(sides) || sides < 2) {
                    showMessage("Number of sides must be at least 2.", "error");
                    currentNumberOfSides = 6; // Reset to default
                    numberOfSidesInput.value = 6;
                    dieCustomOptionsInput.disabled = false; // Enable custom options if sides invalid
                    return false;
                }
                currentNumberOfSides = sides;
                dieCustomOptionsInput.disabled = true; // Disable custom options if number of sides is used
                dieCustomOptionsInput.value = ''; // Clear custom options input
            }
            return true;
        }

        // Event listener for Roll Die button
        rollDieBtn.addEventListener('click', () => {
            if (!updateDieOptions()) return; // Update options and validate

            let chosenOption;
            if (dieOptions.length > 0) { // If custom options are provided
                const resultIndex = Math.floor(Math.random() * dieOptions.length);
                chosenOption = dieOptions[resultIndex];
            } else { // If rolling a standard die with N sides
                chosenOption = Math.floor(Math.random() * currentNumberOfSides) + 1;
            }

            // Start die roll animation
            dieAnimation.textContent = '?'; // Reset text
            dieAnimation.classList.add('rolling');
            rollDieBtn.disabled = true; // Disable button during animation
            customizeDieBtn.disabled = true;
            diePostDecisionActions.classList.add('hidden'); // Hide post-decision actions during roll

            setTimeout(() => {
                dieAnimation.classList.remove('rolling');
                dieAnimation.textContent = chosenOption;
                rollDieBtn.disabled = false; // Re-enable button
                customizeDieBtn.disabled = false;
                diePostDecisionActions.classList.remove('hidden'); // Show post-decision actions
            }, 500); // Animation duration
        });

        // Event listener for Customize Die button
        customizeDieBtn.addEventListener('click', () => {
            dieCustomizationInputs.classList.toggle('hidden');
            if (!dieCustomizationInputs.classList.contains('hidden')) {
                customizeDieBtn.textContent = 'Save Options';
            } else {
                customizeDieBtn.textContent = 'Customize';
                if(updateDieOptions()) { // Save options and show message if successful
                    showMessage("Die options saved!", "info");
                }
            }
        });

        // Event listener for Go Again Die button
        goAgainDieBtn.addEventListener('click', () => {
            // Re-run the roll with the current options
            rollDieBtn.click();
        });

        // Initial setup for input disabling based on user interaction
        dieCustomOptionsInput.addEventListener('input', () => {
            if (dieCustomOptionsInput.value.trim() !== '') {
                numberOfSidesInput.disabled = true;
                numberOfSidesInput.value = ''; // Clear number of sides if custom is used
            } else {
                numberOfSidesInput.disabled = false;
            }
        });

        numberOfSidesInput.addEventListener('input', () => {
            if (numberOfSidesInput.value.trim() !== '' && parseInt(numberOfSidesInput.value, 10) >= 2) {
                dieCustomOptionsInput.disabled = true;
                dieCustomOptionsInput.value = ''; // Clear custom options if number of sides is used
            } else {
                dieCustomOptionsInput.disabled = false;
            }
        });
    </script>
</body>
</html>
